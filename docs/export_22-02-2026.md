Epic Export Pack (Concise)
Epic: 
 — Aligning UI with Retailer-Client Dashboard Vision
Last updated: 2026-02-22

Table of Contents
Summary (what we’re building)
Locked decisions (current)
Specs (source of truth)
Current implementation highlights (what exists in repo)
Tickets (status snapshot)
Recommended development route (next in line)
Demo script (staff AI workflow)
Key code references (for engineers)
1) Summary (what we’re building)
A production-ready ShareView client portal aligned to the legacy retailer-client dashboard, including:

Polished UI layout + consistent component patterns
Real data ingestion via snapshot pipeline
Algorithmic “smart” metrics (domain_metrics)
LLM/AI insights (ai_insights) with staff workflow
A Reports model where client-visible AI is surfaced via reports tied to a snapshot period
Prompt engineering UI (staff editable templates) to control AI output
2) Locked decisions (current)
Portal structure
Main tabs (v1): Overview, Search Terms, Categories, Products, Auctions
Coverage deferred for v1 (deliver later)
Data model split (v1)
domain_metrics = algorithmic / factual components (auto-published)
ai_insights = AI/LLM content (staff workflow: generate → edit → approve → publish)
prompt_templates = staff-editable templates used by AI generation (global templates v1)
page_insights is legacy/transitional
Reports model (v1)
Client-visible AI insights are presented as part of a Report:
Reports can cover one or multiple domains
Reports can be scheduled or created manually
Reports are tied to a snapshot period (month now; week/custom later)
Reports are not visible until approved/published (depending on workflow)
Staff roles (PM-confirmed)
CSS_ADMIN + SALES_TEAM can generate/approve/publish (keep current behavior)
Client report permissions (v1)
Controlled via retailer_config.features_enabled:

allow_report_request (default false)
allow_report_generate (default false)
show_ai_disclaimer (default false)
3) Specs (source of truth)
Epic Brief: 
Core Flows: 
Technical Plan: 
Addendum (Current State + PM Delta): 
4) Current implementation highlights (what exists in repo)
Snapshot pipeline
Aggregation: shareview-platform/services/snapshot-generator/generate-snapshots.ts
Classification: shareview-platform/services/snapshot-classifier/classify-snapshots.ts
Generators
Domain metrics generator: shareview-platform/services/domain-metrics-generator/generate-domain-metrics.ts
AI insights generator: shareview-platform/services/ai-insights-generator/generate-ai-insights.ts
Staff AI workflow (demoable)
Approval dashboard UI: shareview-platform/components/admin/InsightsApprovalDashboard.tsx
Staff page: shareview-platform/app/dashboard/insights-approval/page.tsx
Staff routes:
Generate: shareview-platform/app/api/insights/generate/route.ts
Pending list: shareview-platform/app/api/insights/pending/route.ts
Jobs (polling): shareview-platform/app/api/insights/jobs/route.ts, shareview-platform/app/api/insights/jobs/[id]/route.ts
Edit: shareview-platform/app/api/insights/[id]/route.ts (PUT)
Approve/Reject/Publish: shareview-platform/app/api/insights/[id]/approve/route.ts, .../reject/route.ts, .../publish/route.ts
Prompt templates (demoable)
Migration: shareview-platform/migrations/20260219000000_create_prompt_templates_up.sql
API: shareview-platform/app/api/insights/prompt-templates/route.ts
Prompt hash incorporates style + text: shareview-platform/services/ai-insights-generator/generate-ai-insights.ts
Reports schema (foundation exists)
Reports tables migration: shareview-platform/migrations/20260220000000_create_reports_tables_up.sql
Legacy/transitional endpoint still present
page_insights endpoint: shareview-platform/app/api/page-insights/route.ts (legacy table)
5) Tickets (status snapshot)
Done
ticket:.../8626cd51-e19c-48c9-a4d0-17678a5bceb4 Database Migration
ticket:.../983fbb58-3917-4597-87d9-fabe8c15534d Shared UI Components
ticket:.../3ae5c7c3-ebef-41d8-907e-ee68f1b60c4f Showcase Page Structure
ticket:.../51b9bc83-db43-467e-ac5e-2a7e0ca3d741 T1a Snapshot Aggregation
ticket:.../79a103a3-9ab3-4fe3-8f40-d6d24b361f84 T1a-2 Snapshot Classification
ticket:.../3e7f1022-2d17-4c81-b1c2-634089e9c3c6 T1b Domain Metrics Generator
ticket:.../63dd0619-85b8-4f76-be66-69bcae3909f8 T1c AI Insights Generator
ticket:.../1ec91079-7e67-4a19-978b-19db5f86521e T8 Staff AI Workflow
ticket:.../fced2f85-d5f7-4ff7-9eaf-35eaac41f46e T8a Prompt Templates UI
ticket:.../9d97b5b4-4e9d-4315-8a6f-df598107ee0a TB2 Auctions metrics + remove coverage defaults
Todo / Next
ticket:.../e4dd9179-9644-4d7a-8853-a19621c5f448 TR1 Reports data model & migrations
ticket:.../126d0fb2-e7a9-4aa1-8b82-e28ae36c5aeb TB2a Coverage hardening (sanitize + filter)
ticket:.../75c4c317-7b63-4c96-bada-8b9213ed42de TB1 API endpoints (domain metrics + ai insights + reports)
ticket:.../1382a209-281b-4470-983a-739dc4357a39 TR2 Reports service + generation integration
ticket:.../aba42de0-ff97-4d6b-91b4-2b25710bd48c TR3 Staff reports UI
ticket:.../4a32f241-bc70-41d9-8d7a-e546f4473839 TR4 Client report viewer UI
ticket:.../f425454c-a3e1-4f70-a752-b6aa8f149eae T3 Overview UI integration
ticket:.../e6708a2d-9bac-4ff4-af3a-a0bda92c983e T4-T7 Remaining tabs integration
ticket:.../d58652a2-7775-4cba-af29-39faf13112b3 T9 Populate demo data
6) Recommended development route (next in line)
TR1 (confirm/apply final Reports schema)
TB2a (sanitize legacy configs + filter “coverage” everywhere in v1)
TB1 (implement /api/domain-metrics, /api/ai-insights, /api/reports/*)
includes report permissions via features_enabled.allow_report_request/generate
GET /api/reports/[id] returns minimal per-domain performance tables
TR2 (report creation + publish logic; tie insights + metrics to a report)
TR3/TR4 (staff report mgmt UI + client report viewer)
T3 + T4-T7 (wire portal tabs to new endpoints and reports sub-tab)
T9 (seed demo reports + sample data)
7) Demo script (staff AI + prompt workflow)
Navigate to staff Insights Approval Dashboard
Open Prompt Templates panel
Edit prompt/style (e.g. exec-summary) → Save
Generate insights for a retailer + period
Observe job queued/running/completed
View generated insights in queue
Open editor → modify text → Save/Submit
Approve → Publish
(Optional) Change prompt style → regenerate → show output and prompt hash change
8) Key code references (quick links)
Staff AI dashboard: shareview-platform/components/admin/InsightsApprovalDashboard.tsx
Staff insight routes: shareview-platform/app/api/insights/*
Prompt templates: shareview-platform/app/api/insights/prompt-templates/route.ts
Generators:
shareview-platform/services/domain-metrics-generator/generate-domain-metrics.ts
shareview-platform/services/ai-insights-generator/generate-ai-insights.ts
Reports schema: shareview-platform/migrations/20260220000000_create_reports_tables_up.sql
Legacy endpoint: shareview-platform/app/api/page-insights/route.ts
End of export.